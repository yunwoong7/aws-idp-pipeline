[app]
ns = "aws-idp-ai"
stage = "dev"

[security]
# IP Whitelist for ALB access control
# Add your authorized IP addresses or CIDR blocks here
whitelist = [
  "15.248.0.0/16",
]

# VPC 설정 (주석 해제 시 기존 VPC 사용, 주석 처리 시 새 VPC 생성)
# [vpc]
# vpcId = "vpc-xxxxxxxxx"
# vpcCidr = "10.0.0.0/16"
# maxAzs = 3

[dynamodb]
# DynamoDB 테이블 설정
documentsTableName = "aws-idp-ai-documents" 
pagesTableName = "aws-idp-ai-pages"
segmentsTableName = "aws-idp-ai-segments"
indicesTableName = "aws-idp-ai-indices"

[s3]
# S3 버킷 설정 (계정과 리전이 자동으로 추가됩니다)
documentsBucketName = "aws-idp-ai-documents"

[opensearch]
# OpenSearch 설정
domainName = "aws-idp-ai-opensearch"
indexName = "aws-idp-ai-analysis"
instanceType = "t3.small.search"
instanceCount = 1
dedicatedMasterEnabled = false

[apigateway]
# API Gateway 설정
throttleRateLimit = 1000
throttleBurstLimit = 2000

[bedrock]
# Bedrock AI 모델 설정
analysisAgentModelId = "us.anthropic.claude-3-7-sonnet-20250219-v1:0"
analysisAgentMaxToken = 8192
analysisImageModelId = "us.anthropic.claude-3-7-sonnet-20250219-v1:0"
analysisImageMaxToken = 8192
analysisVideoModelId = "us.twelvelabs.pegasus-1-2-v1:0"
analysisSummarizerModelId = "us.anthropic.claude-3-7-sonnet-20250219-v1:0"
analysisSummarizerMaxToken = 64000
pageSummaryModelId = "us.anthropic.claude-3-5-haiku-20241022-v1:0"
pageSummaryMaxToken = 8192
embeddingsModelId = "amazon.titan-embed-text-v2:0"
embeddingsDimensions = 1024
rerankModelId = "cohere.rerank-v3-5:0"
vectorWeight = 0.6
keywordWeight = 0.4
searchThresholdScore = 0.4

[search]
# 검색 관련 설정
hybridSearchSize = 25  # OpenSearch에서 가져올 초기 후보군 수
rerankTopN = 3  # 리랭킹 후 최종 반환할 결과 수
maxSearchSize = 100  # 최대 검색 가능 수
rerankScoreThreshold = 0.07  # 리랭킹 스코어 임계값 (이 값보다 낮은 결과 제외)

[analysis]
# 분석 관련 설정
previousAnalysisMaxCharacters = 100000
maxIterations = 10

[lambda]
# Lambda 함수 설정
timeout = 30
memorySize = 512
runtime = "python3.13"

[stepfunctions]
# Step Functions 워크플로우 설정
documentProcessingTimeout = 60  # 문서 처리 워크플로우 제한 시간 (분)
maxConcurrency = 50  # ReactAnalysis 병렬 처리 최대 동시 실행 수

[sqs]
# SQS 설정
sqsBatchSize = 1  # 개발 환경에서도 1로 설정 (필요시 변경)
reservedConcurrency = 1  # SQS 트리거 람다의 동시 실행 제한